<div class="mainscreen-toolbar bg-white">
  <div class="flexer--space-between">
    <div class="benji-logo-container">
      <img [src]="darkLogo" alt="Benji Logo" class="benji-logo"/>
    </div>
    <ng-container *ngIf="!isEditor && (activityState && activityState.activity_type !== 'LobbyActivity')">
      <div>
        <div fxLayout="row" fxLayoutGap="8px">
          <!-- Timer control -->
          <ng-container *ngxPermissionsOnly="'ADMIN'" >
            <div class="time-info" fxLayoutAlign="center center">
              <div class="ms-header-timer" *ngIf="showTimer" 
                [matMenuTriggerFor]="timerMenu">
                <benji-number-timer
                  [timer]="timer"
                  endStateText="Times Up!"
                ></benji-number-timer>
              </div>
            </div>
          </ng-container>
                
          <ng-container *ngxPermissionsOnly="'ADMIN'" >
            <div class="option" fxLayoutAlign="center center"
              [matMenuTriggerFor]="timerMenu"
              [matTooltipPosition]="'below'"
              matTooltip="Timer"
              show-delay="100">
                <img src="/assets/img/dark_alarm.svg"/>
                <mat-menu 
                  #timerMenu="matMenu" 
                  class="dynamic-timer-menu" 
                  [overlapTrigger]="false" 
                  xPosition="before">
                  <benji-dynamic-timer 
                    [updateMessage]="activityState"
                    (controlClicked)="controlClicked($event)"
                    (propagate)="propagate($event)">
                  </benji-dynamic-timer>
                </mat-menu>
            </div>
          </ng-container>

          <!-- Grouping control -->
          <ng-container *ngxPermissionsOnly="'ADMIN'">
            <button
              [matMenuTriggerFor]="groupingMenu"
              #groupingMenuTrigger="matMenuTrigger"
              style="width: 0px;">
            </button>
            <div class="option" 
              fxLayoutAlign="center center"
              *ngIf="activityState && 
                (activityState.activity_type === 'CaseStudyActivity' || 
                activityState.activity_type === 'BrainstormActivity')"
              (click)="groupingMenuClicked()"
              [ngClass]="{ active: isGroupingShowing }"
              matTooltip="Groups"
              [matTooltipPosition]="'below'"
              show-delay="100">
              <img src="/assets/img/grouping.svg"/> 
            </div>
            <mat-menu 
              #groupingMenu="matMenu" 
              class="activity-settings-menu "  
              [overlapTrigger]="false" 
              xPosition="before">
              <benji-grouping-control
                [activityState]="activityState"
                (socketMessage)="propagate($event)">
              </benji-grouping-control>
            </mat-menu>
          </ng-container>

          <!-- Grouping Participant Dialog" -->
          <ng-container *ngxPermissionsOnly="'ADMIN'" >
            <div class="option" fxLayoutAlign="center center"
              *ngIf="activityState && activityState.activity_type === 'CaseStudyActivity'"
              (click)="openGroupingParticipantDialog()">
                <img src="/assets/img/grouping/collaborate.svg"/>
            </div>
          </ng-container>

          <!-- Vote control -->
          <!-- <div class="option" 
            fxLayoutAlign="center center"
            *ngIf="activityState && activityState.activity_type === 'BrainstormActivity'"
            [matMenuTriggerFor]="voteMenu"
            matTooltip="Vote"
            [matTooltipPosition]="'below'"
            show-delay="100">
              <img src="/assets/img/thumb.svg"/> 
              <mat-menu 
                #voteMenu="matMenu" 
                class="activity-settings-menu "  
                [overlapTrigger]="false" 
                xPosition="before">
                <benji-vote-control
                  (socketMessage)="brainstormSubmissionComplete($event)">
                </benji-vote-control>
              </mat-menu>
          </div> -->

          <!-- Share control -->
          <!-- <div class="option" 
            fxLayoutAlign="center center"
            *ngIf="isSharingAllowed(activityState)"
            [ngClass]="{ active: isSharing }"
            (click)="startSharingTool()"
            matTooltip="Vote"
            [matTooltipPosition]="'below'"
            show-delay="100">
              <img src="/assets/img/shareIcon.svg"/>
          </div> -->

          <!-- Activity Settings -->
          <ng-container *ngxPermissionsOnly="'ADMIN'">
            <button
              [matMenuTriggerFor]="activitySettingsMenu"
              #activitySettingsMenuTrigger="matMenuTrigger"
              style="width: 0px;"> 
            </button>
            <div 
              *ngIf="isActivitySettingsAllowed(activityState)"
              class="option" 
              (click)="settingsMenuClicked()"
              fxLayoutAlign="center center"
              matTooltip="Settings"
              [matTooltipPosition]="'below'"
              show-delay="100">
                <img src="/assets/img/dark_dial.svg" /> 
            </div>
            <mat-menu 
              class="activity-settings-menu" 
              #activitySettingsMenu="matMenu" 
              yPosition="above"
              [overlapTrigger]="false">
              <benji-activity-settings 
                [activityState]="activityState"
                (controlClicked)="controlClicked($event)">
              </benji-activity-settings>
            </mat-menu>
          </ng-container>

          <!-- Activities Navigation -->
          <ng-container *ngxPermissionsOnly="'ADMIN'">
            <div class="option arrow" fxLayoutAlign="center center" (click)="controlClicked('previous')">
              <img src="/assets/img/chevron_left.svg"/> 
            </div>
            <div class="option" fxLayoutAlign="center center"
              [matMenuTriggerFor]="navigationMenu"
              [matTooltipPosition]="'below'"
              matTooltip="Activities"
              show-delay="100">
                <span>{{ currentActivityIndex }}</span>
                <mat-menu 
                  #navigationMenu="matMenu" 
                  class="activity-settings-menu activity-session-menu"  
                  [overlapTrigger]="false" 
                  xPosition="before">
                  <benji-session-navigation 
                    [activityState]="activityState"
                    [disableControls]="disableControls"
                    (navigate)="navigateToActivity($event)"
                    (setActivityIndex)="setCurrentActivityIndex($event)">
                  </benji-session-navigation>
                </mat-menu>
            </div>

            <div class="option arrow" fxLayoutAlign="center center" (click)="controlClicked('next')" *ngIf="isLastActivity">
              <img src="/assets/img/chevron_right.svg" /> 
            </div>
          </ng-container>

          <button
            mat-button 
            (click)="openSideNav('boards')">
            Borads
          </button>
          <button
            *ngxPermissionsOnly="'ADMIN'"
            mat-button 
            (click)="openSideNav('board-settings')">
            Borad Settings
          </button>
          
        </div>

        <ng-container *ngxPermissionsOnly="'PARTICIPANT'">
          <div fxLayout="row" fxLayoutGap="8px">
            <!-- Participant grouping -->
            <div class="participant-grouping" 
              *ngIf="openGroupAccess">
              <button
                (click)="openGroupingParticipantDialog()">
                {{ 'Select group'}}
              </button>
            </div>
          </div>
        </ng-container>
      </div>
    </ng-container>

  </div>
</div>
