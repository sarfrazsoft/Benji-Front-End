<div class="b-flat-card center-text feedback-card">
  <div class="activity-wrapper">
    <div class="b-flat-card__body" *ngIf="createPitch">
      <div class="twemoji-container" *ngIf="isEmoji(activityState.buildapitchactivity.title_emoji)">
        <app-b-twemoji 
          class="body-emoji participant participant-new-emoji" 
          [text]="activityState.buildapitchactivity.title_emoji">
        </app-b-twemoji>
      </div>
      <h1 class="pn-700 primary-color-darkest build-pitch-h1 participant">{{ activityState.buildapitchactivity.title }}</h1>
      <p class="body-text bap-instructions">{{ activityState.buildapitchactivity.instructions }}</p>
      <!-- <div class="twemoji-container">
        <app-b-twemoji class="body-emoji participant" emoji="🏗️"></app-b-twemoji>
      </div>
      <h1 class="pn-700 primary-color-darkest participant">Fill-in-the-blank</h1>
      <p class="body-text">{{ activityState.buildapitchactivity.instructions }}</p> -->
      <div class="pitch-form fill-blanks">
        <p class="pitch-segment">
          <ng-container *ngFor="let blank of blanksArray">
            <ng-container *ngIf="blank.type === 'label'">
              {{ blank.label }} 
            </ng-container>
            <span
              *ngIf="blank.type === 'blank'"
              #ref 
              id="contenteditablediv"
              class="editable-span"
              [ngClass]="{ 
                vanilla: !blank.focused,
                focused: blank.focused
              }"
              contenteditable="true" 
              (keyup)="updateBlankValue(blank, $event)"
              (focus)="focusFunction(blank)"
              type="text" 
              placement="bottom"
              [textContent]="blank.temp_text">
              {{ blank.temp_text }}
            </span> 
          </ng-container>
        </p>
      </div>
      <button
        class="b-standard-button build-pitch-button bg-primary-color"
        [ngClass]="{ inactive: !pitchValid }"
        (click)="submitPitch()"
      >
        Submit
      </button>
    </div>
  </div>
  <div class="b-flat-card__body" *ngIf="showMyPitch && userPitchExists(myParticipantCode)">
    <div class="your-pitch-label left-text">Your statement:</div>
    <p class="your-pitch left-text" innerHTML="{{ getPitchText(myParticipantCode, act) }}"></p>
    <div *ngIf="isPitchBlank(myParticipantCode)">
      <div
        class="info-subsection primary-color-lighter pn-500"
        fxLayout="row"
        fxLayoutGap="10px"
        fxLayoutAlign="start start"
      >
        <img class="main-screen-utility-icons" src="/assets/img/red_info_icon.png" alt="info" />
        <div class="instruction warning-color left-text">
          Oops! You didn't finish in time. Try to think of something- you still need to present to the group.
        </div>
      </div>
    </div>
  </div>
  <div class="b-flat-card__body" *ngIf="voteNow">
    <h1 class="pn-700 primary-color-darkest">Vote on your favorite</h1>
    <div *ngFor="let pitchSet of act.buildapitchpitch_set; let i = index">
      <benji-vote-pitch
        [user]="pitchSet.participant.participant_code"
        [expanded]="expandedUserArray['' + pitchSet.user]"
        [pitchText]="getPitchText(pitchSet.participant.participant_code, act)"
        [name]="getUserName(pitchSet.participant.participant_code)"
        [(selectedUser)]="selectedUser"
        (userSelected)="userSelected($event)"
        (userExpanded)="userExpanded($event)"
        (userCollapsed)="userCollapsed($event)"
      ></benji-vote-pitch>
    </div>
    <button 
      class="b-standard-button build-pitch-button white-color bg-primary-color center-text"
      *ngIf="selectedUser && !userVoted"
      (click)="submitVote(selectedUser)">
      Submit
    </button>
  </div>
  <div class="b-flat-card__body" *ngIf="thanksForVote">
    <div class="twemoji">
      <app-b-twemoji class="body-emoji" emoji="😊"></app-b-twemoji>
    </div>
    <h1 class="body-heading pn-700 primary-color-darkest">Thanks for your vote</h1>
    <div class="activity-title-description-container">
      <p class="secondary-color-dark pn-500 instruction">Waiting for everyone else to finish voting</p>
    </div>
  </div>
  <div class="b-flat-card__body" *ngIf="lookAtWinningPitch">
    <div class="twemoji">
      <app-b-twemoji class="body-emoji" emoji="🏗️"></app-b-twemoji>
    </div>
    <h1 class="body-heading pn-700 primary-color-darkest">Woo!</h1>
    <div class="activity-title-description-container">
      <p class="secondary-color-dark pn-500 instruction">Take a look at the winner.</p>
    </div>
  </div>
  <div class="b-flat-card__body" *ngIf="yourPitchWon">
    <div class="twemoji">
      <app-b-twemoji class="body-emoji" emoji="👏"></app-b-twemoji>
    </div>
    <h1 class="body-heading pn-700 primary-color-darkest">Congrats!!</h1>
    <div class="activity-title-description-container">
      <p class="secondary-color-dark pn-500 instruction">You got the most votes.</p>
    </div>
  </div>
</div>