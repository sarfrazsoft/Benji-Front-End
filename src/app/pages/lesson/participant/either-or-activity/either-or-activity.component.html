<ng-container>
  <div class="b-flat-card center-text roleplay-card">
    <div class="b-flat-card__title">
      <h2 class="pn-500">Where do you stand?</h2>
    </div>

    <!-- Ask for Prediction -->
    <div
      class="b-flat-card__body"
      *ngIf="!state.standing_complete && !predictionComplete() && !preferenceComplete()"
    >
      <div class="b-flat-card__question-no pn-500 secondary-color-dark">Question 1:</div>

      <h2 class="pn-700 primary-color-darkest b-flat-card__question" [innerHTML]="state.prediction_text"></h2>

      <div class="pn-700" fxLayout="row" fxLayoutAlign="center" fxLayoutGap="20px">
        <div class="">
          <div
            class="radio-mock-button"
            [ngClass]="{
              'selected-option': state.left_choice.id === selectedPrediction
            }"
            (click)="choosePrediction(state.left_choice)"
            *ngIf="isEmoji(state.left_choice.choice_img_url)"
          >
            <div class="emoji-div">
              <app-b-twemoji [text]="state.left_choice.choice_img_url"></app-b-twemoji>
            </div>
            <span>
              {{ state.left_choice.prediction_text }}
            </span>
          </div>
        </div>

        <div class="">
          <div
            class="radio-mock-button"
            [ngClass]="{
              'selected-option': state.right_choice.id === selectedPrediction
            }"
            (click)="choosePrediction(state.right_choice)"
            *ngIf="isEmoji(state.right_choice.choice_img_url)"
          >
            <div class="emoji-div">
              <app-b-twemoji [text]="state.right_choice.choice_img_url"></app-b-twemoji>
            </div>
            <span>
              {{ state.right_choice.prediction_text }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Ask for preference -->
    <div
      class="b-flat-card__body"
      *ngIf="!state.standing_complete && predictionComplete() && !preferenceComplete()"
    >
      <div class="b-flat-card__question-no pn-500 secondary-color-dark">Question 2:</div>

      <h2 class="pn-700 primary-color-darkest b-flat-card__question" [innerHTML]="state.preference_text"></h2>

      <div class="pn-700" fxLayout="row" fxLayoutAlign="center" fxLayoutGap="20px">
        <div class="">
          <div
            *ngIf="isEmoji(state.left_choice.choice_img_url)"
            class="radio-mock-button"
            [ngClass]="{
              'selected-option': state.left_choice.id === selectedPreference
            }"
            (click)="choosePreference(state.left_choice)"
          >
            <div class="emoji-div">
              <app-b-twemoji [text]="state.left_choice.choice_img_url"></app-b-twemoji>
            </div>
            <span>
              {{ state.left_choice.preference_text }}
            </span>
          </div>
        </div>

        <div class="">
          <div
            class="radio-mock-button"
            [ngClass]="{
              'selected-option': state.right_choice.id === selectedPreference
            }"
            (click)="choosePreference(state.right_choice)"
            *ngIf="isEmoji(state.right_choice.choice_img_url)"
          >
            <div class="emoji-div">
              <app-b-twemoji [text]="state.right_choice.choice_img_url"></app-b-twemoji>
            </div>
            <span>
              {{ state.right_choice.preference_text }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Ask to stand on each side -->
    <div
      *ngIf="!state.standing_complete && preferenceComplete() && predictionComplete()"
      class="b-flat-card__body"
    >
      <ng-container *ngIf="getUserPreferredChoice()">
        <h1 class="pn-700 primary-color-darkest b-flat-card__question">Stand on your side</h1>
        <div class="pn-700">
          <div class="twemoji-container">
            <app-b-twemoji [text]="getUserPreferredChoice().choice_img_url"> </app-b-twemoji>
          </div>
          <h2 class="pn-500 secondary-color-dark">
            <span [innerHTML]="getUserPreferredChoice().collective_name"></span>
            to the <span class="primary-color-darkest">{{ getUserSide() }}</span> of the main screen
          </h2>
        </div>
      </ng-container>
      <ng-container *ngIf="getUserPreferredChoice() === undefined">
        <h1 class="pn-700 primary-color-darkest b-flat-card__question">
          Really? Canâ€™t decide? Stand in the middle of the room
        </h1>
      </ng-container>
    </div>

    <!-- Show results -->
    <div
      *ngIf="state.standing_complete && preferenceComplete() && predictionComplete()"
      class="b-flat-card__body"
    >
      <!-- Show It's a tie -->
      <ng-container *ngIf="getGroupPercentagePreference() === 50">
        <h1 class="pn-700 primary-color-darkest b-flat-card__question">Wow, a tie!</h1>
        <div fxLayout="column" fxLayoutGap="5vh" fxLayoutAlign="center center">
          <div class="result-tie-emoji" fxLayout="row">
            <div class="twemoji-container" *ngIf="isEmoji(state.right_choice.choice_img_url)">
              <app-b-twemoji [text]="state.left_choice.choice_img_url"></app-b-twemoji>
            </div>
            <div class="twemoji-container" *ngIf="isEmoji(state.right_choice.choice_img_url)">
              <app-b-twemoji [text]="state.right_choice.choice_img_url"></app-b-twemoji>
            </div>
          </div>
          <h3 class="pn-700 secondary-color-dark">Your group is a perfectly even split.</h3>
        </div>
      </ng-container>

      <!-- Show normal results -->
      <ng-container *ngIf="getGroupPercentagePreference() !== 50">
        <h1 *ngIf="evaluateUserPrediction()" class="pn-700 primary-color-darkest b-flat-card__question">
          Your prediction was {{ evaluateUserPrediction() }}
        </h1>
        <div class="pn-700">
          <div class="twemoji-container">
            <app-b-twemoji [text]="getGroupPreferredChoice().choice_img_url"></app-b-twemoji>
          </div>
          <h2 class="pn-500 secondary-color-dark">
            Most of this group are
            <span [innerHTML]="getGroupPreferredChoice().collective_name"></span>
          </h2>
        </div>
      </ng-container>
    </div>
  </div>
</ng-container>
