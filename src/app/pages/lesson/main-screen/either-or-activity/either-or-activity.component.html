<div class="either-or-activity mainscreen-activity" fxLayoutAlign="center">
  <ng-container *ngIf="!state.standing_complete && !state.preference_complete">
    <!-- prediction -->

    <ng-container *ngIf="!state.prediction_complete">
      <div class="single-column-activity">
        <div class="question-emojis" fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="3vw">
          <div>
            <div class="twemoji-container" *ngIf="isEmoji(state.left_choice.choice_img_url)">
              <app-b-twemoji [emoji]="emoji.getEmoji(state.left_choice.choice_img_url)"></app-b-twemoji>
            </div>
          </div>
          <div>
            <div class="twemoji-container" *ngIf="isEmoji(state.right_choice.choice_img_url)">
              <app-b-twemoji [emoji]="emoji.getEmoji(state.right_choice.choice_img_url)"></app-b-twemoji>
            </div>
          </div>
        </div>
        <div class="activity-question-title-container">
          <h1 class="primary-color-darkest pn-700 question">Question 1:</h1>
        </div>
        <div class="activity-question-description-container">
          <p class="secondary-color-dark pn-500" [innerHTML]="state.prediction_text"></p>
        </div>
        <div class="forms-submitted primary-color-darkest pn-600">
          {{ state.predictions.length }}/{{ activityState.lesson_run.participant_set.length }}
          answers submitted
        </div>
      </div>
    </ng-container>

    <!-- preference -->
    <ng-container *ngIf="state.prediction_complete">
      <ng-container *ngIf="!isRemoteSession">
        <div class="single-column-activity">
          <div class="question-emojis" fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="3vw">
            <div>
              <div class="twemoji-container" *ngIf="isEmoji(state.left_choice.choice_img_url)">
                <app-b-twemoji [emoji]="emoji.getEmoji(state.left_choice.choice_img_url)"></app-b-twemoji>
              </div>
            </div>
            <div>
              <div class="twemoji-container" *ngIf="isEmoji(state.right_choice.choice_img_url)">
                <app-b-twemoji [emoji]="emoji.getEmoji(state.right_choice.choice_img_url)"></app-b-twemoji>
              </div>
            </div>
          </div>
          <div class="activity-question-title-container">
            <h1 class="primary-color-darkest pn-700 question">Question 2:</h1>
          </div>
          <div class="activity-question-description-container">
            <p class="secondary-color-dark pn-500" [innerHTML]="state.preference_text"></p>
          </div>
          <div class="forms-submitted primary-color-darkest pn-600">
            {{ state.preferences.length }}/{{ activityState.lesson_run.participant_set.length }}
            answers submitted
          </div>
        </div>
      </ng-container>

      <ng-container *ngIf="isRemoteSession">
        <div class="mainscreen-activity ms-act--multi-column pair-activity" style="width: 100%">
          <div
            class="mainscreen-activity__column mainscreen-activity__column--50 bg-secondary-color-lightest pair-activity__pairs"
          >
            <p class="ms-act__section-text secondary-color-dark">
              {{ state.left_choice.preference_text }}
            </p>
            <ul class="ul-find-partner">
              <li
                class="li-find-partner primary-color-darkest pn-600"
                *ngFor="let user of leftChoiceUsers"
                [ngClass]="{
                  'long-list': leftChoiceUsers.length > 30
                }"
              >
                {{ getParticipantName(user) }}
              </li>
            </ul>
          </div>
          <div
            class="mainscreen-activity__column mainscreen-activity__column--50 bg-secondary-color-lightest pair-activity__pairs"
          >
            <p class="ms-act__section-text secondary-color-dark">
              {{ state.right_choice.preference_text }}
            </p>
            <ul class="ul-find-partner">
              <li
                class="li-find-partner primary-color-darkest pn-600"
                *ngFor="let user of rightChoiceUsers"
                [ngClass]="{
                  'long-list': rightChoiceUsers.length > 30
                }"
              >
                {{ getParticipantName(user) }}
              </li>
            </ul>
          </div>
        </div>
      </ng-container>
    </ng-container>
  </ng-container>

  <div
    *ngIf="!state.standing_complete && state.preference_complete && state.prediction_complete"
    class="single-column-activity"
  >
    <div fxLayoutAlign="center center">
      <div class="move-your-side" fxLayout="row" fxLayoutAlign="stretch center" fxLayoutGap="2.5vw">
        <div>
          <div class="twemoji-container">
            <app-b-twemoji emoji="⬅️"></app-b-twemoji>
          </div>
        </div>
        <div>
          <div class="twemoji-container" *ngIf="isEmoji(state.left_choice.choice_img_url)">
            <app-b-twemoji [emoji]="emoji.getEmoji(state.left_choice.choice_img_url)"></app-b-twemoji>
          </div>
        </div>
        <h1 fxFlex class="primary-color-darkest pn-700 question">Stand on your side</h1>
        <div>
          <div class="twemoji-container" *ngIf="isEmoji(state.right_choice.choice_img_url)">
            <app-b-twemoji [emoji]="emoji.getEmoji(state.right_choice.choice_img_url)"></app-b-twemoji>
          </div>
        </div>
        <div>
          <div class="twemoji-container">
            <app-b-twemoji emoji="➡️"></app-b-twemoji>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div
    class="result"
    fxLayout="row"
    *ngIf="state.standing_complete && state.preference_complete && state.prediction_complete"
  >
    <div fxLayout="column" fxFlex>
      <div>
        <h1 class="primary-color-darkest pn-700 question">Prediction:</h1>
      </div>
      <div class="mb-auto">
        <h1 class="secondary-color-dark pn-500 question">
          <em>{{ getGroupPercentagePrediction() }}%</em> of you thought that there would be more
          <em><span [innerHTML]="getGroupPredictionChoice().collective_name"></span></em>
          in this group
        </h1>
      </div>
      <div
        class="twemoji-container"
        *ngIf="isEmoji(getGroupPredictionChoice().choice_img_url) && !hideResultEmoji"
      >
        <app-b-twemoji [emoji]="emoji.getEmoji(getGroupPredictionChoice().choice_img_url)"></app-b-twemoji>
      </div>
    </div>
    <div fxLayout="column" fxFlex>
      <div>
        <h1 class="primary-color-darkest pn-700 question">Reality:</h1>
      </div>
      <div>
        <h1
          class="pn-500 question"
          [ngClass]="{
            'success-color':
              getGroupPredictionEvaluation() === 'Correct!' || getGroupPredictionEvaluation() === 'Tie!',
            'warning-color': getGroupPredictionEvaluation() === 'Incorrect!'
          }"
        >
          {{ getGroupPredictionEvaluation() }}
        </h1>
      </div>
      <div class="mb-auto">
        <h1 *ngIf="!isGroupPredictionEvaluationTie()" class="secondary-color-dark pn-500 question">
          <em>{{ getGroupPercentagePreference() }}%</em> of you are
          <em>
            <span [innerHTML]="getGroupPreferredChoice().collective_name"></span>
          </em>
        </h1>
        <h1 *ngIf="isGroupPredictionEvaluationTie()" class="secondary-color-dark pn-500 question">
          You're an even 50/50 split!
        </h1>
      </div>
      <div>
        <div
          class="twemoji-container"
          *ngIf="!isGroupPredictionEvaluationTie() && isEmoji(getGroupPreferredChoice().choice_img_url)"
        >
          <app-b-twemoji [emoji]="emoji.getEmoji(getGroupPreferredChoice().choice_img_url)"></app-b-twemoji>
        </div>
        <div *ngIf="isGroupPredictionEvaluationTie()">
          <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="3vw">
            <div>
              <div class="twemoji-container" *ngIf="isEmoji(state.left_choice.choice_img_url)">
                <app-b-twemoji [emoji]="emoji.getEmoji(state.left_choice.choice_img_url)"></app-b-twemoji>
              </div>
            </div>
            <div>
              <div class="twemoji-container" *ngIf="isEmoji(state.right_choice.choice_img_url)">
                <app-b-twemoji [emoji]="emoji.getEmoji(state.right_choice.choice_img_url)"></app-b-twemoji>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="hint-activity__linear-timer-container">
    <benji-linear-timer
      [timer]="state.prediction_countdown_timer"
      [endAudio]="'bell.wav'"
      [timerOffset]="avgServerTimeOffset"
    ></benji-linear-timer>
    <benji-linear-timer
      [timer]="state.preference_countdown_timer"
      [endAudio]="'bell.wav'"
      [timerOffset]="avgServerTimeOffset"
    ></benji-linear-timer>
    <benji-linear-timer
      [timer]="state.stand_on_side_countdown_timer"
      [endAudio]="'bell.wav'"
      [timerOffset]="avgServerTimeOffset"
    ></benji-linear-timer>
    <benji-linear-timer
      [timer]="getNextActStartTimer()"
      [endAudio]="'bell.wav'"
      [timerOffset]="avgServerTimeOffset"
    ></benji-linear-timer>
  </div>
</div>
